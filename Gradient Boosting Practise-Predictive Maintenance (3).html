import pandas as pd
import numpy as np
cd
/Users/shivom
cd downloads
/Users/shivom/Downloads
encode = pd.read_csv('encoders (1) (1).csv', index_col=['date'], parse_dates=['date'])
encode
id	scanner	min	max	err	pixels	minf	maxf	errf	created_at	updated_at
date											
2017-12-17	12	K219	35435	35933	1.40	6	35681	35688	0.02	NaN	26:16.5
2017-12-18	30	H161	35155	36382	3.43	14	35731	35761	0.08	NaN	26:16.9
2017-12-18	47	K211	35305	36042	2.07	43	35692	35739	0.13	NaN	10:57.5
2017-12-18	48	K212	35216	36225	2.82	61	35686	35726	0.11	NaN	10:57.5
2017-12-18	49	K220	35196	36259	2.98	11	35709	35724	0.04	NaN	10:57.5
...	...	...	...	...	...	...	...	...	...	...	...
2018-07-03	2748	K171	35109	35912	2.26	50	35504	35531	0.08	NaN	24:51.4
2017-07-12	2749	K211	-1	-1	0.00	-1	-1	-1	0.00	NaN	NaN
2017-07-12	2750	K212	-1	-1	0.00	-1	-1	-1	0.00	NaN	NaN
2018-07-03	2751	K220	35181	36229	2.94	9	35702	35715	0.04	NaN	42:19.4
2018-07-03	2752	K221	35288	36266	2.73	3	35734	35737	0.01	NaN	42:19.4
2752 rows × 11 columns

encode.shape
(2752, 11)
encode.info()
<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 2752 entries, 2017-12-17 to 2018-07-03
Data columns (total 11 columns):
id            2752 non-null int64
scanner       2752 non-null object
min           2752 non-null int64
max           2752 non-null int64
err           2752 non-null float64
pixels        2752 non-null int64
minf          2752 non-null int64
maxf          2752 non-null int64
errf          2752 non-null float64
created_at    0 non-null float64
updated_at    1921 non-null object
dtypes: float64(3), int64(6), object(2)
memory usage: 258.0+ KB
encode.head()
id	scanner	min	max	err	pixels	minf	maxf	errf	created_at	updated_at
date											
2017-12-17	12	K219	35435	35933	1.40	6	35681	35688	0.02	NaN	26:16.5
2017-12-18	30	H161	35155	36382	3.43	14	35731	35761	0.08	NaN	26:16.9
2017-12-18	47	K211	35305	36042	2.07	43	35692	35739	0.13	NaN	10:57.5
2017-12-18	48	K212	35216	36225	2.82	61	35686	35726	0.11	NaN	10:57.5
2017-12-18	49	K220	35196	36259	2.98	11	35709	35724	0.04	NaN	10:57.5
encode.tail()
id	scanner	min	max	err	pixels	minf	maxf	errf	created_at	updated_at
date											
2018-07-03	2748	K171	35109	35912	2.26	50	35504	35531	0.08	NaN	24:51.4
2017-07-12	2749	K211	-1	-1	0.00	-1	-1	-1	0.00	NaN	NaN
2017-07-12	2750	K212	-1	-1	0.00	-1	-1	-1	0.00	NaN	NaN
2018-07-03	2751	K220	35181	36229	2.94	9	35702	35715	0.04	NaN	42:19.4
2018-07-03	2752	K221	35288	36266	2.73	3	35734	35737	0.01	NaN	42:19.4
 from datetime import datetime
oldformat = '2018-03-07'
datetimeobject = datetime.strptime(oldformat,'%Y-%d-%m')
newformat = datetimeobject.strftime('%m%d%Y')
print (newformat)
07032018
import seaborn as sns
import matplotlib.pyplot as plt
#using naive method 
gretr=encode['err']
k = 12
print ("The list : " + str(gretr)) 
count = 0
for i in gretr : 
    if i > k : 
        count = count + 1
print ("The numbers greater than 12 : " + str(count)) 
The list : date
2017-12-17    1.40
2017-12-18    3.43
2017-12-18    2.07
2017-12-18    2.82
2017-12-18    2.98
              ... 
2018-07-03    2.26
2017-07-12    0.00
2017-07-12    0.00
2018-07-03    2.94
2018-07-03    2.73
Name: err, Length: 2752, dtype: float64
The numbers greater than 12 : 8
#using naive method 
gretr=encode['err']
k = 12
print ("The list : " + str(gretr)) 
count = 0
for i in gretr : 
    if i < k : 
        count = count + 1
print ("The numbers lesser than 12 : " + str(count)) 
The list : date
2017-12-17    1.40
2017-12-18    3.43
2017-12-18    2.07
2017-12-18    2.82
2017-12-18    2.98
              ... 
2018-07-03    2.26
2017-07-12    0.00
2017-07-12    0.00
2018-07-03    2.94
2018-07-03    2.73
Name: err, Length: 2752, dtype: float64
The numbers lesser than 12 : 2744
erf=encode['errf']
k = 0.5
print ("The list : " + str(erf)) 
count = 0
for i in erf : 
    if i > k : 
        count = count + 1
print ("The numbers greater than 0.5 : " + str(count)) 
The list : date
2017-12-17    0.02
2017-12-18    0.08
2017-12-18    0.13
2017-12-18    0.11
2017-12-18    0.04
              ... 
2018-07-03    0.08
2017-07-12    0.00
2017-07-12    0.00
2018-07-03    0.04
2018-07-03    0.01
Name: errf, Length: 2752, dtype: float64
The numbers greater than 0.5 : 5
erf=encode['errf']
k = 0.5
print ("The list : " + str(erf)) 
count = 0
for i in erf : 
    if i < k : 
        count = count + 1
print ("The numbers lesser than 0.5 : " + str(count)) 
The list : date
2017-12-17    0.02
2017-12-18    0.08
2017-12-18    0.13
2017-12-18    0.11
2017-12-18    0.04
              ... 
2018-07-03    0.08
2017-07-12    0.00
2017-07-12    0.00
2018-07-03    0.04
2018-07-03    0.01
Name: errf, Length: 2752, dtype: float64
The numbers lesser than 0.5 : 2747
encode.isnull().sum()
id               0
scanner          0
min              0
max              0
err              0
pixels           0
minf             0
maxf             0
errf             0
created_at    2752
updated_at     831
dtype: int64
encode.info()
<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 2752 entries, 2017-12-17 to 2018-07-03
Data columns (total 11 columns):
id            2752 non-null int64
scanner       2752 non-null object
min           2752 non-null int64
max           2752 non-null int64
err           2752 non-null float64
pixels        2752 non-null int64
minf          2752 non-null int64
maxf          2752 non-null int64
errf          2752 non-null float64
created_at    0 non-null float64
updated_at    1921 non-null object
dtypes: float64(3), int64(6), object(2)
memory usage: 258.0+ KB
del encode['created_at']
encode
id	scanner	min	max	err	pixels	minf	maxf	errf	updated_at
date										
2017-12-17	12	K219	35435	35933	1.40	6	35681	35688	0.02	26:16.5
2017-12-18	30	H161	35155	36382	3.43	14	35731	35761	0.08	26:16.9
2017-12-18	47	K211	35305	36042	2.07	43	35692	35739	0.13	10:57.5
2017-12-18	48	K212	35216	36225	2.82	61	35686	35726	0.11	10:57.5
2017-12-18	49	K220	35196	36259	2.98	11	35709	35724	0.04	10:57.5
...	...	...	...	...	...	...	...	...	...	...
2018-07-03	2748	K171	35109	35912	2.26	50	35504	35531	0.08	24:51.4
2017-07-12	2749	K211	-1	-1	0.00	-1	-1	-1	0.00	NaN
2017-07-12	2750	K212	-1	-1	0.00	-1	-1	-1	0.00	NaN
2018-07-03	2751	K220	35181	36229	2.94	9	35702	35715	0.04	42:19.4
2018-07-03	2752	K221	35288	36266	2.73	3	35734	35737	0.01	42:19.4
2752 rows × 10 columns

encode['updated_at']=encode['updated_at'].replace(np.nan,0)
encode['updated_at']
date
2017-12-17    26:16.5
2017-12-18    26:16.9
2017-12-18    10:57.5
2017-12-18    10:57.5
2017-12-18    10:57.5
               ...   
2018-07-03    24:51.4
2017-07-12          0
2017-07-12          0
2018-07-03    42:19.4
2018-07-03    42:19.4
Name: updated_at, Length: 2752, dtype: object
encode=pd.read_csv('encoders (1) (1).csv')
encode
id	date	scanner	min	max	err	pixels	minf	maxf	errf	created_at	updated_at
0	12	17/12/17	K219	35435	35933	1.40	6	35681	35688	0.02	NaN	26:16.5
1	30	18/12/17	H161	35155	36382	3.43	14	35731	35761	0.08	NaN	26:16.9
2	47	18/12/17	K211	35305	36042	2.07	43	35692	35739	0.13	NaN	10:57.5
3	48	18/12/17	K212	35216	36225	2.82	61	35686	35726	0.11	NaN	10:57.5
4	49	18/12/17	K220	35196	36259	2.98	11	35709	35724	0.04	NaN	10:57.5
...	...	...	...	...	...	...	...	...	...	...	...	...
2747	2748	07/03/18	K171	35109	35912	2.26	50	35504	35531	0.08	NaN	24:51.4
2748	2749	07/12/17	K211	-1	-1	0.00	-1	-1	-1	0.00	NaN	NaN
2749	2750	07/12/17	K212	-1	-1	0.00	-1	-1	-1	0.00	NaN	NaN
2750	2751	07/03/18	K220	35181	36229	2.94	9	35702	35715	0.04	NaN	42:19.4
2751	2752	07/03/18	K221	35288	36266	2.73	3	35734	35737	0.01	NaN	42:19.4
2752 rows × 12 columns

encode['updated_at']=encode['updated_at'].replace(np.nan,0)
encode
id	date	scanner	min	max	err	pixels	minf	maxf	errf	created_at	updated_at
0	12	17/12/17	K219	35435	35933	1.40	6	35681	35688	0.02	NaN	26:16.5
1	30	18/12/17	H161	35155	36382	3.43	14	35731	35761	0.08	NaN	26:16.9
2	47	18/12/17	K211	35305	36042	2.07	43	35692	35739	0.13	NaN	10:57.5
3	48	18/12/17	K212	35216	36225	2.82	61	35686	35726	0.11	NaN	10:57.5
4	49	18/12/17	K220	35196	36259	2.98	11	35709	35724	0.04	NaN	10:57.5
...	...	...	...	...	...	...	...	...	...	...	...	...
2747	2748	07/03/18	K171	35109	35912	2.26	50	35504	35531	0.08	NaN	24:51.4
2748	2749	07/12/17	K211	-1	-1	0.00	-1	-1	-1	0.00	NaN	0
2749	2750	07/12/17	K212	-1	-1	0.00	-1	-1	-1	0.00	NaN	0
2750	2751	07/03/18	K220	35181	36229	2.94	9	35702	35715	0.04	NaN	42:19.4
2751	2752	07/03/18	K221	35288	36266	2.73	3	35734	35737	0.01	NaN	42:19.4
2752 rows × 12 columns

encode.info()
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 2752 entries, 0 to 2751
Data columns (total 12 columns):
id            2752 non-null int64
date          2752 non-null object
scanner       2752 non-null object
min           2752 non-null int64
max           2752 non-null int64
err           2752 non-null float64
pixels        2752 non-null int64
minf          2752 non-null int64
maxf          2752 non-null int64
errf          2752 non-null float64
created_at    0 non-null float64
updated_at    2752 non-null object
dtypes: float64(3), int64(6), object(3)
memory usage: 258.1+ KB
encode['scanner'].value_counts()
K121    78
K115    78
K114    78
K168    77
K171    75
        ..
H134     4
H169     2
H168     2
H172     2
H170     2
Name: scanner, Length: 73, dtype: int64
encode["scanner"]= encode["scanner"].astype('category')
encode['scanner']=encode.scanner.cat.codes 
encode
id	date	scanner	min	max	err	pixels	minf	maxf	errf	created_at	updated_at
0	12	17/12/17	66	35435	35933	1.40	6	35681	35688	0.02	NaN	26:16.5
1	30	18/12/17	28	35155	36382	3.43	14	35731	35761	0.08	NaN	26:16.9
2	47	18/12/17	63	35305	36042	2.07	43	35692	35739	0.13	NaN	10:57.5
3	48	18/12/17	64	35216	36225	2.82	61	35686	35726	0.11	NaN	10:57.5
4	49	18/12/17	67	35196	36259	2.98	11	35709	35724	0.04	NaN	10:57.5
...	...	...	...	...	...	...	...	...	...	...	...	...
2747	2748	07/03/18	57	35109	35912	2.26	50	35504	35531	0.08	NaN	24:51.4
2748	2749	07/12/17	63	-1	-1	0.00	-1	-1	-1	0.00	NaN	0
2749	2750	07/12/17	64	-1	-1	0.00	-1	-1	-1	0.00	NaN	0
2750	2751	07/03/18	67	35181	36229	2.94	9	35702	35715	0.04	NaN	42:19.4
2751	2752	07/03/18	68	35288	36266	2.73	3	35734	35737	0.01	NaN	42:19.4
2752 rows × 12 columns

encode['scanner'] = encode.scanner.astype('float64')
encode['scanner']
0       66.0
1       28.0
2       63.0
3       64.0
4       67.0
        ... 
2747    57.0
2748    63.0
2749    64.0
2750    67.0
2751    68.0
Name: scanner, Length: 2752, dtype: float64
encode.info()
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 2752 entries, 0 to 2751
Data columns (total 12 columns):
id            2752 non-null int64
date          2752 non-null object
scanner       2752 non-null float64
min           2752 non-null int64
max           2752 non-null int64
err           2752 non-null float64
pixels        2752 non-null int64
minf          2752 non-null int64
maxf          2752 non-null int64
errf          2752 non-null float64
created_at    0 non-null float64
updated_at    2752 non-null object
dtypes: float64(4), int64(6), object(2)
memory usage: 258.1+ KB
encode.describe()
id	scanner	min	max	err	pixels	minf	maxf	errf	created_at
count	2752.000000	2752.000000	2752.000000	2752.000000	2752.000000	2752.000000	2752.000000	2752.000000	2752.000000	0.0
mean	1376.500000	44.653343	33252.667151	34240.375000	2.804077	37.546148	33746.241279	33782.083212	0.136374	NaN
std	794.578295	20.406317	8003.631376	8211.525764	4.337743	32.597722	8112.993215	8094.095021	3.812031	NaN
min	1.000000	0.000000	-1.000000	-1.000000	0.000000	-1.000000	-1.000000	-1.000000	0.000000	NaN
25%	688.750000	32.750000	35035.750000	35986.000000	1.840000	18.000000	35655.000000	35680.000000	0.030000	NaN
50%	1376.500000	50.000000	35218.000000	36100.000000	2.420000	32.000000	35707.000000	35727.000000	0.060000	NaN
75%	2064.250000	59.000000	35348.000000	36258.000000	3.182500	48.000000	35719.000000	35746.000000	0.080000	NaN
max	2752.000000	72.000000	45275.000000	47057.000000	200.010000	175.000000	45717.000000	46344.000000	200.010000	NaN
encode['updated_at']=encode['updated_at'].dropna(0)
del encode['created_at']
del encode['id']
erf.hist()
<matplotlib.axes._subplots.AxesSubplot at 0x1017e3110>

encode['scanner'] = encode.scanner.astype('float64')
encode
date	scanner	min	max	err	pixels	minf	maxf	errf	updated_at
0	17/12/17	66.0	35435	35933	1.40	6	35681	35688	0.02	26:16.5
1	18/12/17	28.0	35155	36382	3.43	14	35731	35761	0.08	26:16.9
2	18/12/17	63.0	35305	36042	2.07	43	35692	35739	0.13	10:57.5
3	18/12/17	64.0	35216	36225	2.82	61	35686	35726	0.11	10:57.5
4	18/12/17	67.0	35196	36259	2.98	11	35709	35724	0.04	10:57.5
...	...	...	...	...	...	...	...	...	...	...
2747	07/03/18	57.0	35109	35912	2.26	50	35504	35531	0.08	24:51.4
2748	07/12/17	63.0	-1	-1	0.00	-1	-1	-1	0.00	0
2749	07/12/17	64.0	-1	-1	0.00	-1	-1	-1	0.00	0
2750	07/03/18	67.0	35181	36229	2.94	9	35702	35715	0.04	42:19.4
2751	07/03/18	68.0	35288	36266	2.73	3	35734	35737	0.01	42:19.4
2752 rows × 10 columns

#import matplotlib.pyplot as plt
#import seaborn as sns
#py.init_notebook_mode(connected=True)
#from plotly.offline import init_notebook_mode, iplot
#init_notebook_mode(connected=True)
#import plotly.offline as offline
#from datetime import datetime

#import plotly.graph_objs as go
#import plotly.offline as py

#errdate = [go.Scatter(x=encode.date, y=encode['err'])]

#py.iplot(errdate, filename = 'time-series-simple')
#From the figure we are able to see that there is one scanner with the highest , err and errf values which
# is nearing 200
#errfdate = [go.Scatter(x=encode.date, y=encode['errf'])]

#py.iplot(errfdate, filename = 'time-series-simple')
#From the figure we are able to see that there is one scanner with the highest , err and errf values which
# is nearing 200
#updatedate = [go.Scatter(x=encode.updated_at, y=encode['date'])]

#py.iplot(updatedate, filename = 'time-series-simple')
#d['date'] = pd.to_datetime(d['date'])
#d['date']=d['date'].map(dt.datetime.toordinal)

#d['date'].head()


#from sklearn.metrics import roc_curve
#import matplotlib.pyplot as plt 
#fpr, tpr, thresholds = roc_curve(y_test, decision.predict_proba(X_test)[:,1])
#plt.figure()
#plt.plot(fpr, tpr, color='darkorange', label='Decision Tree (area = %0.2f)' % roc_auc)
#plt.plot([0, 1], [0, 1], color='navy', lw=2, linestyle='--')
#plt.xlim([0.0, 1.0])
#plt.ylim([0.0, 1.05])
#plt.xlabel('False Positive Rate')
#plt.ylabel('True Positive Rate')
#plt.title('Receiver Operating Characteristic')
#plt.legend(loc="lower right")
#plt.show()
parse_dates=['date']
encode
date	scanner	min	max	err	pixels	minf	maxf	errf	updated_at
0	17/12/17	66.0	35435	35933	1.40	6	35681	35688	0.02	26:16.5
1	18/12/17	28.0	35155	36382	3.43	14	35731	35761	0.08	26:16.9
2	18/12/17	63.0	35305	36042	2.07	43	35692	35739	0.13	10:57.5
3	18/12/17	64.0	35216	36225	2.82	61	35686	35726	0.11	10:57.5
4	18/12/17	67.0	35196	36259	2.98	11	35709	35724	0.04	10:57.5
...	...	...	...	...	...	...	...	...	...	...
2747	07/03/18	57.0	35109	35912	2.26	50	35504	35531	0.08	24:51.4
2748	07/12/17	63.0	-1	-1	0.00	-1	-1	-1	0.00	0
2749	07/12/17	64.0	-1	-1	0.00	-1	-1	-1	0.00	0
2750	07/03/18	67.0	35181	36229	2.94	9	35702	35715	0.04	42:19.4
2751	07/03/18	68.0	35288	36266	2.73	3	35734	35737	0.01	42:19.4
2752 rows × 10 columns

plt.figure(figsize=(15, 7))
plt.plot(encode.err)
plt.title('Error Value(routine data)')
plt.grid(True)
plt.show()

plt.figure(figsize=(15, 7))
plt.plot(encode.errf)
plt.title('Error Filtered Value(routine data)')
plt.grid(True)
plt.show()

encode.info()
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 2752 entries, 0 to 2751
Data columns (total 10 columns):
date          2752 non-null object
scanner       2752 non-null float64
min           2752 non-null int64
max           2752 non-null int64
err           2752 non-null float64
pixels        2752 non-null int64
minf          2752 non-null int64
maxf          2752 non-null int64
errf          2752 non-null float64
updated_at    2752 non-null object
dtypes: float64(3), int64(5), object(2)
memory usage: 215.1+ KB
#import pandas as pd
#encode["date"] = pd.to_datetime(encode["date"]).dt.strftime("%Y%m%d")
#print( date)
encode['date']
0       17/12/17
1       18/12/17
2       18/12/17
3       18/12/17
4       18/12/17
          ...   
2747    07/03/18
2748    07/12/17
2749    07/12/17
2750    07/03/18
2751    07/03/18
Name: date, Length: 2752, dtype: object
encode
date	scanner	min	max	err	pixels	minf	maxf	errf	updated_at
0	17/12/17	66.0	35435	35933	1.40	6	35681	35688	0.02	26:16.5
1	18/12/17	28.0	35155	36382	3.43	14	35731	35761	0.08	26:16.9
2	18/12/17	63.0	35305	36042	2.07	43	35692	35739	0.13	10:57.5
3	18/12/17	64.0	35216	36225	2.82	61	35686	35726	0.11	10:57.5
4	18/12/17	67.0	35196	36259	2.98	11	35709	35724	0.04	10:57.5
...	...	...	...	...	...	...	...	...	...	...
2747	07/03/18	57.0	35109	35912	2.26	50	35504	35531	0.08	24:51.4
2748	07/12/17	63.0	-1	-1	0.00	-1	-1	-1	0.00	0
2749	07/12/17	64.0	-1	-1	0.00	-1	-1	-1	0.00	0
2750	07/03/18	67.0	35181	36229	2.94	9	35702	35715	0.04	42:19.4
2751	07/03/18	68.0	35288	36266	2.73	3	35734	35737	0.01	42:19.4
2752 rows × 10 columns

#from sklearn import preprocessing
#from sklearn import utils

#labelenc = preprocessing.LabelEncoder()
#t = labelenc.fit_transform(y)
#print(t)
#print(utils.multiclass.type_of_target(y))
#print(utils.multiclass.type_of_target(y.astype('int')))
#print(utils.multiclass.type_of_target(t))
encode['scanner'] = encode['scanner'].astype('category')
# Assigning numerical values and storing in another column
encode['scanner'] = encode['scanner'].cat.codes
encode['scanner']
0       66
1       28
2       63
3       64
4       67
        ..
2747    57
2748    63
2749    64
2750    67
2751    68
Name: scanner, Length: 2752, dtype: int8
encode['date'] = pd.to_datetime(encode['date'], errors='coerce')
encode['date']
0      2017-12-17
1      2017-12-18
2      2017-12-18
3      2017-12-18
4      2017-12-18
          ...    
2747   2018-07-03
2748   2017-07-12
2749   2017-07-12
2750   2018-07-03
2751   2018-07-03
Name: date, Length: 2752, dtype: datetime64[ns]
X=encode.iloc[:,2:]
X
min	max	err	pixels	minf	maxf	errf	updated_at
0	35435	35933	1.40	6	35681	35688	0.02	26:16.5
1	35155	36382	3.43	14	35731	35761	0.08	26:16.9
2	35305	36042	2.07	43	35692	35739	0.13	10:57.5
3	35216	36225	2.82	61	35686	35726	0.11	10:57.5
4	35196	36259	2.98	11	35709	35724	0.04	10:57.5
...	...	...	...	...	...	...	...	...
2747	35109	35912	2.26	50	35504	35531	0.08	24:51.4
2748	-1	-1	0.00	-1	-1	-1	0.00	0
2749	-1	-1	0.00	-1	-1	-1	0.00	0
2750	35181	36229	2.94	9	35702	35715	0.04	42:19.4
2751	35288	36266	2.73	3	35734	35737	0.01	42:19.4
2752 rows × 8 columns

del encode['updated_at']
encode
date	scanner	min	max	err	pixels	minf	maxf	errf
0	2017-12-17	66	35435	35933	1.40	6	35681	35688	0.02
1	2017-12-18	28	35155	36382	3.43	14	35731	35761	0.08
2	2017-12-18	63	35305	36042	2.07	43	35692	35739	0.13
3	2017-12-18	64	35216	36225	2.82	61	35686	35726	0.11
4	2017-12-18	67	35196	36259	2.98	11	35709	35724	0.04
...	...	...	...	...	...	...	...	...	...
2747	2018-07-03	57	35109	35912	2.26	50	35504	35531	0.08
2748	2017-07-12	63	-1	-1	0.00	-1	-1	-1	0.00
2749	2017-07-12	64	-1	-1	0.00	-1	-1	-1	0.00
2750	2018-07-03	67	35181	36229	2.94	9	35702	35715	0.04
2751	2018-07-03	68	35288	36266	2.73	3	35734	35737	0.01
2752 rows × 9 columns

encode['scanner']=encode['scanner'].astype('float64')
encode.info()
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 2752 entries, 0 to 2751
Data columns (total 9 columns):
date       2752 non-null datetime64[ns]
scanner    2752 non-null float64
min        2752 non-null int64
max        2752 non-null int64
err        2752 non-null float64
pixels     2752 non-null int64
minf       2752 non-null int64
maxf       2752 non-null int64
errf       2752 non-null float64
dtypes: datetime64[ns](1), float64(3), int64(5)
memory usage: 193.6 KB
X=encode.iloc[:,2:]
X
min	max	err	pixels	minf	maxf	errf
0	35435	35933	1.40	6	35681	35688	0.02
1	35155	36382	3.43	14	35731	35761	0.08
2	35305	36042	2.07	43	35692	35739	0.13
3	35216	36225	2.82	61	35686	35726	0.11
4	35196	36259	2.98	11	35709	35724	0.04
...	...	...	...	...	...	...	...
2747	35109	35912	2.26	50	35504	35531	0.08
2748	-1	-1	0.00	-1	-1	-1	0.00
2749	-1	-1	0.00	-1	-1	-1	0.00
2750	35181	36229	2.94	9	35702	35715	0.04
2751	35288	36266	2.73	3	35734	35737	0.01
2752 rows × 7 columns

y=encode.iloc[:,1:2]
y
scanner
0	66.0
1	28.0
2	63.0
3	64.0
4	67.0
...	...
2747	57.0
2748	63.0
2749	64.0
2750	67.0
2751	68.0
2752 rows × 1 columns

from sklearn.model_selection import train_test_split
X_train,X_test,y_train,y_test=train_test_split(X,y,train_size=0.8,)
print(X_train.shape)
print(y_train.shape)
print(X_test.shape)
print(y_test.shape)
(2201, 7)
(2201, 1)
(551, 7)
(551, 1)
#from sklearn.linear_model import LinearRegression
#model=linear_model.LinearRegression()

#from sklearn.linear_model import LogisticRegression
#model=linear_model.LogisticRegression

#from sklearn.tree import DecisionTreeClassifier
#model = DecisionTreeClassifier(criterion='entropy',max_depth= 8)

#from sklearn.ensemble import RandomForestClassifier
#model=RandomForestClassifier(criterion='entropy')

from sklearn.ensemble import GradientBoostingClassifier
model=GradientBoostingClassifier(n_estimators=50)

#from sklearn import neighbors
#model=KNeighboursClassifiers()


#from sklearn import metrics



#Grid Search
#parameters = {'criterion':('gini', 'entropy'), 'max_depth':[8, 10,12]}
#dt = DecisionTreeClassifier()
#clf = GridSearchCV(dt, parameters)
#clf.fit(X_train, y_train)
model.fit(X_test,y_test)
/Volumes/Scratch/Karishma/anaconda3/lib/python3.7/site-packages/sklearn/ensemble/gradient_boosting.py:1450: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
GradientBoostingClassifier(criterion='friedman_mse', init=None,
                           learning_rate=0.1, loss='deviance', max_depth=3,
                           max_features=None, max_leaf_nodes=None,
                           min_impurity_decrease=0.0, min_impurity_split=None,
                           min_samples_leaf=1, min_samples_split=2,
                           min_weight_fraction_leaf=0.0, n_estimators=50,
                           n_iter_no_change=None, presort='auto',
                           random_state=None, subsample=1.0, tol=0.0001,
                           validation_fraction=0.1, verbose=0,
                           warm_start=False)
predicted = model.predict(X_test)
predicted
array([52., 11.,  0., 71., 50., 12., 40., 51., 46., 15., 48., 69., 62.,
       65., 46., 55., 71., 53., 53., 40., 60., 29., 59., 59.,  3., 50.,
       54., 51.,  1., 28., 67., 49.,  0., 70.,  1., 26., 37., 53., 47.,
        0.,  9., 53.,  1., 58., 58., 29., 49., 39., 50., 51., 30., 47.,
       59., 49.,  3.,  4., 30., 49., 57., 30., 29., 53., 46.,  9.,  3.,
       41., 50., 19.,  2., 31.,  2.,  3., 33., 57., 70., 60., 42., 62.,
       60., 42., 33., 62., 37., 28., 41.,  0., 30., 40., 40., 29., 69.,
       54., 40., 43., 12., 54., 45., 48., 71., 62., 30., 47., 28., 31.,
       72., 31., 13., 13., 68.,  9., 41., 59., 46., 47., 57., 45.,  0.,
       68., 52., 57., 47., 31., 55., 58., 11., 49., 69., 62., 72., 47.,
       13., 67., 18., 71., 67., 50., 60., 48.,  1., 55., 67., 46., 44.,
       49., 62., 41., 57., 43., 72., 66.,  3., 61., 51.,  1., 66.,  9.,
       69.,  2., 59., 62., 54.,  2., 39., 50., 52., 59., 40., 30., 48.,
       52., 60., 46., 67., 31., 65.,  9., 59., 46., 46., 55., 47., 56.,
       47.,  0., 28., 54., 37.,  9., 48., 57., 37., 49., 30., 28., 48.,
       61., 62., 54., 17., 42., 42., 69., 43., 51., 28.,  2., 51.,  9.,
        2., 60., 59., 47., 43., 31.,  9.,  1., 28., 55., 51., 71., 47.,
        9., 39., 40., 65., 58.,  3., 47., 47.,  0., 65., 58., 41.,  2.,
       60.,  2., 70., 48.,  9., 29., 52., 41., 53., 50., 37., 47., 41.,
       51., 41., 50., 41., 71., 45.,  9., 40., 58., 54.,  0., 39., 58.,
       57., 70., 53., 33., 52., 29., 57., 32., 61.,  0., 52., 57., 60.,
       41., 28., 37., 50., 33., 58., 23.,  3., 70., 70., 30., 51., 55.,
       71., 53., 47., 15., 43., 69., 51., 57., 40., 41., 70.,  0., 71.,
       46., 42., 47., 28., 57., 69.,  0., 54., 70.,  9., 60., 65., 30.,
       58., 45., 60., 28., 49., 29., 51., 72., 70., 52., 62., 50., 35.,
       46., 42., 70.,  1., 51., 35.,  1., 56., 56., 48., 51., 39., 13.,
       39.,  1.,  9., 43., 29., 52., 32., 15., 39.,  3., 51., 39., 66.,
        2., 56., 59., 61., 51., 29.,  2., 56., 56., 47.,  0., 42.,  0.,
       41., 51., 71., 49., 69., 33., 31., 72., 46., 21., 59., 50., 37.,
       40., 47.,  1.,  1.,  1., 56., 69., 55., 52., 58.,  0., 39., 41.,
       53., 58., 21., 46., 31., 52., 54., 60., 28., 55., 42., 32., 65.,
       47., 42., 30., 58., 48., 62.,  9.,  2., 65., 58., 48., 53.,  9.,
       62., 27., 48., 43., 68.,  0., 61.,  1., 57.,  9., 51., 59., 62.,
       66., 60.,  9., 40., 55., 47., 29., 30., 69.,  9., 40.,  0., 54.,
       68., 69., 59.,  2., 30., 55., 61., 58., 51., 66., 58., 23., 43.,
       70., 30., 56., 70., 72., 69.,  9., 42., 69.,  3.,  9., 29., 39.,
       60., 39., 47., 48., 39.,  2., 43., 58.,  3., 54., 70., 72., 26.,
        1., 13., 40., 69., 58.,  9., 68., 30.,  1., 53., 29.,  2.,  1.,
       46., 30.,  3., 54., 49., 71.,  2., 42., 47., 65., 57., 71., 29.,
       62., 46., 33., 59., 39., 28., 59.,  2., 56.,  3., 40., 52., 23.,
       58., 49., 36., 34., 49., 53., 40., 42., 54., 59., 69., 54., 57.,
       70., 56., 56., 47., 52., 44., 30., 54., 61.,  9.,  3., 70., 69.,
       29., 59.,  0., 52., 62.])
#Confusion Matrix
from sklearn.metrics import confusion_matrix
print(confusion_matrix(y_test, predicted))
[[17  0  0 ...  0  0  0]
 [ 0 16  0 ...  0  0  0]
 [ 0  0 16 ...  0  0  0]
 ...
 [ 0  0  0 ... 15  0  0]
 [ 0  0  0 ...  0 11  0]
 [ 0  0  0 ...  0  0  7]]
#Classification Report
from sklearn.metrics import classification_report
print(classification_report(y_test, predicted))
              precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        17
         1.0       1.00      1.00      1.00        16
         2.0       1.00      1.00      1.00        16
         3.0       1.00      1.00      1.00        13
         4.0       1.00      1.00      1.00         1
         9.0       0.23      1.00      0.37         5
        10.0       0.00      0.00      0.00         1
        11.0       1.00      1.00      1.00         2
        12.0       1.00      1.00      1.00         2
        13.0       1.00      1.00      1.00         5
        14.0       0.00      0.00      0.00         4
        15.0       1.00      1.00      1.00         3
        17.0       1.00      1.00      1.00         1
        18.0       1.00      1.00      1.00         1
        19.0       1.00      1.00      1.00         1
        21.0       1.00      1.00      1.00         2
        23.0       1.00      1.00      1.00         3
        26.0       1.00      1.00      1.00         2
        27.0       1.00      1.00      1.00         1
        28.0       1.00      1.00      1.00        12
        29.0       1.00      1.00      1.00        14
        30.0       1.00      1.00      1.00        16
        31.0       1.00      1.00      1.00         8
        32.0       1.00      1.00      1.00         3
        33.0       1.00      1.00      1.00         6
        34.0       1.00      1.00      1.00         1
        35.0       1.00      1.00      1.00         2
        36.0       1.00      1.00      1.00         1
        37.0       1.00      1.00      1.00         7
        39.0       1.00      1.00      1.00        13
        40.0       1.00      1.00      1.00        15
        41.0       1.00      1.00      1.00        13
        42.0       1.00      1.00      1.00        12
        43.0       1.00      1.00      1.00         9
        44.0       1.00      1.00      1.00         2
        45.0       1.00      1.00      1.00         4
        46.0       1.00      0.93      0.97        15
        47.0       1.00      1.00      1.00        22
        48.0       1.00      1.00      1.00        12
        49.0       1.00      1.00      1.00        12
        50.0       1.00      1.00      1.00        11
        51.0       1.00      1.00      1.00        18
        52.0       1.00      1.00      1.00        14
        53.0       1.00      1.00      1.00        12
        54.0       1.00      1.00      1.00        15
        55.0       1.00      0.91      0.95        11
        56.0       1.00      1.00      1.00        11
        57.0       1.00      0.88      0.93        16
        58.0       1.00      1.00      1.00        18
        59.0       1.00      0.94      0.97        17
        60.0       1.00      1.00      1.00        13
        61.0       1.00      1.00      1.00         7
        62.0       1.00      1.00      1.00        14
        63.0       0.00      0.00      0.00         5
        64.0       0.00      0.00      0.00         1
        65.0       1.00      1.00      1.00         8
        66.0       1.00      1.00      1.00         5
        67.0       1.00      1.00      1.00         5
        68.0       1.00      1.00      1.00         5
        69.0       1.00      0.94      0.97        17
        70.0       1.00      1.00      1.00        15
        71.0       1.00      1.00      1.00        11
        72.0       1.00      1.00      1.00         7

    accuracy                           0.97       551
   macro avg       0.92      0.93      0.92       551
weighted avg       0.97      0.97      0.97       551

/Volumes/Scratch/Karishma/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:1437: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
import sklearn.metrics as metrics
prob=model.predict_proba(X_test)
pred=prob[:,1]
fpr,tpr,=metrics.roc_curve(expected,predicted)
roc_auc=metrics.auc(fpr,tpr)



import matplotlib.pyplot as plt

plt.plot(fpr,tpr,'b',label='AUC= %0.2f' % roc_auc)
plt.legend(loc='lower right')
plt.plot([0,1],[0,1],'r--')
plt.xlim([0,1])
plt.ylim([0,1])
plt.ylabel('True Positive Rate')
plt.xlabel('False Positive Rate')
plt.show()
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-78-3d59a63a3f41> in <module>
      2 prob=model.predict_proba(X_test)
      3 pred=prob[:,1]
----> 4 fpr,tpr,=metrics.roc_curve(expected,predicted)
      5 roc_auc=metrics.auc(fpr,tpr)
      6 

NameError: name 'expected' is not defined
from sklearn.model_selection import cross_val_score 
accuracies = cross_val_score(estimator = model, X = X_test,\
     y = y_test, cv = 20)
print("Accuracy Mean {} Accuracy Variance \
     {}".format(accuracies.mean(),accuracies.std()))
from sklearn.metrics import accuracy_score

accuracy_score(y_test,predicted)
expected=y_test
expected.hist()
plt.scatter(y_test, predicted,  color='orange')
from sklearn.preprocessing import LabelEncoder
es = LabelEncoder()
encode["scanner"] = es.fit_transform(encode["scanner"])
encode
encode['scanner']=encode['scanner'].astype('float64')
encode.info()
encode['scanner'].value_counts()
y_test.shape
y_test['scanner'].value_counts()
y_test.head(30)
